## Rebind prefix — outer: C-a, nested/SSH: C-b
# Detect if we're already inside a multiplexer (local tmux → TERM=screen*/tmux*)
if-shell 'case "$TERM" in screen*|tmux*) exit 0;; *) exit 1;; esac' \
  'set -g prefix C-b' \
  'set -g prefix C-a'

# Double-press to pass prefix to the inner session (works for both)
bind C-a send-prefix
bind C-b send-prefix

## Status bar at top
set-option -g status-position top

## Allow for ctrl+arrow keys to move forward/backword words instead of char.
## This is needed especially for vim.
set-window-option -g xterm-keys on

## Mouse
set-option -g mouse off

## Scrollback history
## I memory tested tmux and it doesn't seem to pre-allocate memory until it
## needs to use that memory for scrollback.
set-option -g history-limit 100000

## Set window notifications
## This shows the changed window tab aspect at the top of tmux if a window has
## had activity while out of focus.
set-window-option -g monitor-activity on
set-option -g visual-activity on

## No more machine counting. Start indexes at 1 instead of 0 :-)
set-option -g base-index 1
set-window-option -g pane-base-index 1

## Misc
set-option -g clock-mode-style 24
set-option -g mode-keys vi
set-window-option -g aggressive-resize on
set-window-option -g monitor-activity on
set-option -g renumber-windows on
set -s escape-time 0

set -g default-shell /home/linuxbrew/.linuxbrew/bin/zsh
set -g default-command "/home/linuxbrew/.linuxbrew/bin/zsh -l"

## Hot keys
bind-key -n F2 previous-window
bind-key -n F3 next-window

## Powerline
run-shell 'tmux set-environment -g PATH "$HOME/.local/bin:/home/linuxbrew/.linuxbrew/bin:/home/linuxbrew/.linuxbrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games"'
run-shell 'powerline-config tmux setup'
set-environment -g POWERLINE_COMMAND 'powerline'
